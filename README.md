Q.1 - CALCULATE TOTAL REVENUE GENERATE FROM PIZZA SALES
                                            
                                      select round(sum(quantity *p.price),2) as Total_Sales from order_details od join pizzas p on od.pizza_id = p.pizza_id;

Q.2 RETRIEVE THE TOTAL NUMBER OF ORDERS PLACED
                                         
                                          SELECT COUNT(ORDER_ID) TOTAL_NUMBER_OF_ORDERS FROM ORDERS;                     

 Q.3 IDENTIFY THE HIGHEST PRIZE PIZZA.

               SELECT PT.NAME , P.PRICE FROM PIZZA_TYPES PT JOIN PIZZAS P ON PT.PIZZA_TYPE_ID = P.PIZZA_TYPE_ID ORDER BY P.PRICE DESC LIMIT 1;                                         

Q.4 IDENTIFY THE MOST COMMON PIZZA SIZE ORDERED.

              SELECT P.SIZE, SUM(QUANTITY) AS NUMBER_OF_ORDERS FROM PIZZAS P JOIN ORDER_DETAILS OD ON P.PIZZA_ID = OD.PIZZA_ID GROUP BY P.SIZE ORDER BY COUNT(QUANTITY) DESC LIMIT 1;

Q.5 CATEGORIES WISE DISCTRIBUTION OF PIZZAS TYPES.

           SELECT CATEGORY,COUNT(CATEGORY) FROM PIZZA_TYPES GROUP BY CATEGORY;

Q.6 LIST TOP 5 MOST ORDERED PIZZA TYPES ALONG WITH THEIR QUANTITIES.
 
     SELECT PT.NAME , SUM(OD.QUANTITY) QUANTITIES FROM PIZZA_TYPES PT JOIN PIZZAS P ON PT.PIZZA_TYPE_ID = P.PIZZA_TYPE_ID JOIN ORDER_DETAILS OD ON P.PIZZA_ID = OD.PIZZA_ID GROUP BY PT.NAME ORDER BY SUM(OD.QUANTITY) DESC LIMIT 5;

Q.7 DETERMINE THE DISTRIBUTION OF ORDERS BY HOUR OF THE DAY.

    SELECT HOUR(TIME) AS HOUR ,COUNT(ORDER_ID) AS ORDER_COUNT FROM ORDERS GROUP BY HOUR(TIME) ORDER BY COUNT(ORDER_ID);

Q.8 JOIN THE NECESSARY TABLES TO FIND THE TOTAL QUANTITY OF EACH PIZZA CATEGORY ORDERED

    SELECT PT.CATEGORY , SUM(OD.QUANTITY) QUANTITIES FROM PIZZA_TYPES PT JOIN PIZZAS P ON PT.PIZZA_TYPE_ID = P.PIZZA_TYPE_ID JOIN ORDER_DETAILS OD ON P.PIZZA_ID = OD.PIZZA_ID GROUP BY PT.CATEGORY ORDER BY SUM(OD.QUANTITY) DESC;

Q.9 FIND OUT THE AVERAGE OF QUANTITY SOLD PER DAY.

    SELECT ROUND(AVG(QUANTITY),2) AS AVERAGE_QUANTITY FROM (SELECT (O.DATE) , SUM(OD.QUANTITY) AS QUANTITY FROM ORDERS O JOIN ORDER_DETAILS OD ON O.ORDER_ID = OD.ORDER_ID GROUP BY (O.DATE)) AS ORDER_QUANTITY;

Q.10 DETERMINE THE TOP 3 MOST ORDERED PIZZA TYPES BASED ON REVENUE.

    SELECT PT.NAME AS PIZZA_TYPES, ROUND(SUM(OD.QUANTITY*P.PRICE),0) AS TOTAL_REVENUE FROM PIZZA_TYPES PT JOIN PIZZAS P ON PT.PIZZA_TYPE_ID = P.PIZZA_TYPE_ID JOIN ORDER_DETAILS OD ON P.PIZZA_ID = OD.PIZZA_ID GROUP BY PT.NAME ORDER BY SUM(OD.QUANTITY*P.PRICE) DESC LIMIT 3;

Q.11 CALLCULATE THE PERCENTAGE CONTRIBUTION OF EACH PIZZA TYPE TO TOTAL REVENUE.

    SELECT PT.CATEGORY , ROUND(SUM(OD.QUANTITY*P.PRICE)/(SELECT (SUM(QUANTITY*PRICE)) FROM PIZZAS P JOIN ORDER_DETAILS OD ON P.PIZZA_ID = OD.PIZZA_ID)*100,1) AS CONTRIBUTION FROM PIZZA_TYPES PT JOIN PIZZAS P ON PT.PIZZA_TYPE_ID = P.PIZZA_TYPE_ID JOIN ORDER_DETAILS OD ON P.PIZZA_ID = OD.PIZZA_ID GROUP BY PT.CATEGORY;

Q.12 ANALYZE THE CUMULATIVE REVENVUE GENERATED OVER TIME

    SELECT DATE , SUM(REVENUE) OVER(ORDER BY DATE) AS CUM_REVENUE FROM (SELECT O.DATE, SUM(OD.QUANTITY*P.PRICE) REVENUE FROM PIZZAS P JOIN ORDER_DETAILS OD ON P.PIZZA_ID = OD.PIZZA_ID JOIN ORDERS O ON OD.ORDER_ID = O.ORDER_ID GROUP BY O.DATE ORDER BY O.DATE) AS SALES;



Q.13 DETERMINE THE TOP 3 MOST ORDERED PIZZA TYPES BASED ON REVENUE FOR EACH PIZZA CATEGORY.
  
     SELECT CATEGORY, NAME, REVENUE , RN FROM (SELECT CATEGORY, NAME, REVENUE , RANK() OVER (PARTITION BY CATEGORY ORDER BY REVENUE DESC) AS RN FROM (SELECT PT.CATEGORY, PT.NAME , SUM(OD.QUANTITY*P.PRICE) AS REVENUE FROM PIZZA_TYPES PT JOIN PIZZAS P ON PT.PIZZA_TYPE_ID = P.PIZZA_TYPE_ID JOIN ORDER_DETAILS OD ON OD.PIZZA_ID = P.PIZZA_ID GROUP BY PT.CATEGORY, PT.NAME) AS A) AS B WHERE RN<=3;
    
  
     
